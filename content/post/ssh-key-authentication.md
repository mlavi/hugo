---
date: "2018-04-22T12:46:39-07:00"
tags: ['ssh', 'authentication', 'Windows', 'cloud-init', 'Linux', 'calm', 'security']
title: 'SSH Key Authentication Overview'
---
For those of you new to automation, Linux, and SSH keypairs:
 Calm Marketplace blueprints leverage all of these with cloud-init to
 enable security best-practices, but it can be overwhelming on first
 exposure to handle every link in the chain to launch your first blueprint.

<!--more-->
# Under Construction #
I will continue to update and expand this blog, it serves as a script for
 a quick video I plan to make.

# The Basics #

- Linux operating system images ready for the cloud do not have any
  accounts with credentials by default.
  - Therefore, one cannot remotely log in to a cloud VM = security best practice.
- Static passwords are pets, passwords should have a dynamic lifecycle.
  - But if you must use a static password, make it mathematically secure.
  - SSH keys = long mathematical passwords, broken into public and private parts.

Combining these two ideas together, one would want to insert
 SSH public keys onto a cloud VM during instantiation.
 For Linux, cloud-init provides this facility.

# The Details #

- Can be generated by ssh-keygen in Linux, MacOS and by PuTTY-gen or cygwin on Windows.
- Make your keys passphraseless (no password to unlock) and store them in a secure place.
- Now the question becomes: how do I put the SSH public key onto a VM image?
  - Easiest way:
    - bake credentials into the VM image by putting SSH cred on an VM,
    - export a snapshot of the VM,
    - use that as your image with a pre-seeded SSH credential.
    - We use the easy way at Calm bootcamps, but it is a bad security practice.
      - At that point, in the Calm blueprint: you can select that image with
      the SSH credentials and upload your private key into the Credentials
      section of the blueprint.
  - Security best practice manner:
    - For Linux, use a cloud-init enabled image
    - Use cloud-init to inject your public key upon VM boot
    (you can do this for AHV VMs with the guest-customization area in Calm)
     as a runtime variable
    - Give Calm your private key as a runtime credential during launch
    - This is the practice we use for the Marketplace blueprints on Linux.

Please see this Nutanix Knowledge Base article:
https://portal.nutanix.com/#/page/kbs/details?targetId=kA00e000000XfDKCA0
